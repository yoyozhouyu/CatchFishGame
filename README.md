# 海底狩猎游戏 (Underwater Hunting Game)

## 项目概述

这是一个竖屏网页版海底狩猎游戏，玩家扮演潜水员在海底世界中使用鱼枪捕猎各种海洋生物。游戏采用第三人称正侧面视角，提供沉浸式的海底探险体验。

## 游戏特色

- 🌊 真实的海底环境模拟
- 🎯 精准的鱼枪射击系统
- 🐟 多样化的海洋生物AI
- ⚡ 体力和氧气管理系统
- 🎮 直观的触控操作界面

## 核心游戏机制

### 1. 游戏视角与环境

- **视角**: 第三人称正侧面视角
- **环境设定**:
  - 上方区域：海面环境
  - 主要游戏区域：海底世界
  - 地形：包含各种固定的海底地形障碍物（珊瑚礁、岩石、海草等）
  - **海中障碍物系统**：
    - 海底固定障碍物：珊瑚礁、岩石、海草等位于海底区域
    - 海中悬浮障碍物：漂浮的海藻团、沉船残骸、大型岩石等分布在海水中层
    - 海面附近障碍物：漂浮物、浮木等位于海面附近区域
  - **障碍物碰撞系统**：
    - 每个障碍物都有对应的碰撞盒（圆形或矩形）
    - 珊瑚礁：圆形碰撞盒，半径与视觉大小匹配
    - 海草：矩形碰撞盒，宽度和高度与视觉大小匹配
    - 海底地面：矩形碰撞盒，覆盖整个海底区域
    - 海中悬浮障碍物：圆形或矩形碰撞盒，根据形状选择
    - 漂浮物：圆形碰撞盒，适合不规则形状

### 2. 主角控制系统

#### 移动控制
- **左下角虚拟摇杆**: 控制主角在水中的游动方向，
- **右下角加速按钮**: 消耗体力提升游动速度
- **碰撞检测**:
  - 主角具有圆形碰撞盒，半径与视觉大小匹配
  - 无法穿越地形障碍物，但不会被卡住
  - 碰撞时平滑滑动而非硬停止
- **出生位置系统**:
  - 主角在游戏开始时出现在水面附近（游戏区域上方10-20%位置）
  - 模拟潜水员从水面开始下潜的真实场景
  - 初始位置必须避开所有障碍物
  - 确保游戏开始时主角不会被卡在障碍物中
  - 如果默认位置有障碍物，自动寻找最近的安全位置

#### 射击系统
- **右下角圆形射击按钮**: 可向任意方向发射鱼枪，以按钮轮盘控制方向，在按钮区域松开则会取消释放
- **鱼枪物理**:
  - 鱼枪朝向需要有虚线显示出来
  - 鱼线的长度有限，到了就不会再伸长
  - 发射后速度逐渐减慢
  - 射中目标后形成鱼线连接
  - 鱼线，遇障碍物会产生物理缠绕弯曲
  - **鱼枪碰撞检测**：鱼枪具有小型圆形碰撞盒，遇到障碍物时停止或反弹
- **鱼线拉拽系统**:
  - 击中鱼类后，鱼枪变为可拉拽状态
  - PC端：按住空格键进行拉拽（射击和拉拽共用空格键）
  - 移动端：显示拉拽按钮，按住拉拽
  - 拉拽过程消耗玩家体力
  - 鱼类会反抗拉拽，消耗自身体力
  - 如果鱼游远了，鱼线会相应拉长
  - 鱼线张力影响拉拽效果和体力消耗

#### 资源管理
- **体力系统**: 
  - 自动恢复至最大值
  - 使用加速功能时消耗
  - 右上角进度条显示
- **氧气系统**:
  - 潜水时间限制
  - 右上角进度条显示
- **金币系统**:
  - 游戏开始时拥有100金币
  - 上方显示金币栏
  - 将鱼拉到水面后获得金币
  - 不同鱼类价值不同：小鱼(5金币)、大鱼(15金币)、章鱼(25金币)
  - 获得金币时显示飘字提示
- **鱼线补充系统**:
  - 鱼拉到水面消失后，渔枪可以再次发射
  - 鱼线断裂后，上浮到水面会自动补充鱼线
  - 补充鱼线扣除10金币
  - 显示"-10 鱼线补充"的红色飘字提醒
- **昏厥复活系统**:
  - 氧气耗尽时弹出昏厥提示界面
  - 扣除一定金币作为救援费用
  - 复活后出现在水面附近
  - 氧气和体力完全恢复
  - 显示扣除金币的飘字提醒
- **游戏失败系统**:
  - 金币为0时弹出游戏失败界面
  - 显示本次游戏的详细统计信息
  - 包含重新开始按钮
  - 点击后重置游戏状态重新开始
- **背景音乐系统**:
  - 游戏启动时自动播放背景音乐
  - 支持音量控制和静音切换
  - 循环播放海底主题音乐
  - 提供音乐控制按钮

### 3. 鱼线机制

- **连接效果**: 鱼枪命中后在主角与猎物间建立鱼线
- **物理特性**: 
  - 默认为直线连接
  - 碰撞地形时产生折角效果
  - 每次碰撞降低耐久值
- **耐久系统**: 
  - 专用进度条显示耐久度
  - 耐久值归零时鱼线断裂，猎物逃脱
- **互动影响**: 主角与猎物的移动会相互影响

### 4. 猎物系统

#### 生物类型
- **大鱼**: 力量强、移动慢、体力高(100)、价值15金币
- **小鱼**: 速度快、体力低(50)、容易捕获、价值5金币
- **章鱼**: 特殊移动模式、中等属性、体力75、价值25金币

#### 鱼类体力系统
- **体力属性**: 每条鱼都有独立的体力值，根据鱼类大小而定
- **体力消耗**:
  - 快速游动时消耗体力，消耗速度根据鱼类大小调整
  - 被击中后快速逃脱时大量消耗体力
  - 自然游动时消耗少量体力
- **体力恢复**:
  - 停止游动时自动恢复体力
  - 恢复速度固定，所有鱼类相同
- **疲劳机制**:
  - 体力耗尽时鱼会停止游动，进入疲劳状态
  - 体力恢复到25%时重新开始游动
- **体力显示**:
  - 每条鱼上方显示独立的体力条
  - 体力条大小与鱼的体力条相同(120×20像素)
  - 颜色状态：绿色(>60%) → 黄色(30-60%) → 红色(<30%)

#### AI行为
- **自主移动**: 各种生物在海底自由游动，消耗少量体力
- **逃脱机制**:
  - 被鱼枪击中后立即快速朝背离主角方向游动
  - 逃脱时大量消耗体力，速度比平时快2-3倍
  - 被鱼线连接后会间歇性消耗体力加速逃脱
- **体力管理**:
  - 初始体力满值，根据鱼类大小而定
  - 快速游动时消耗体力，不同鱼类消耗速度不同
  - 体力耗尽时停止游动，进入疲劳状态
  - 停止游动时自动恢复体力
  - 体力恢复到25%时重新开始游动
- **疲劳状态**:
  - 体力为0时鱼会完全停止移动
  - 疲劳状态下更容易被捕获
  - 体力恢复期间无法逃脱或加速
- **差异化设计**:
  - 不同生物的游动速度、体力消耗、恢复速度各不相同
  - 大鱼体力高但消耗快，小鱼体力低但恢复快
- **碰撞系统**:
  - 每种生物都有圆形碰撞盒，半径根据生物大小设定
  - 生物会避开障碍物，不会穿越地形
  - 生物之间也有碰撞检测，避免重叠
- **出生位置系统**:
  - 所有生物（鱼类）的初始出生位置必须避开障碍物
  - 使用多次尝试算法确保出生位置安全
  - 如果多次尝试后仍无法找到安全位置，则放弃生成该生物

## 技术规格

### 开发框架
- **前端**: HTML5 Canvas + JavaScript
- **物理引擎**: 自定义2D物理系统
- **响应式设计**: 适配竖屏移动设备

### 核心系统模块
1. **渲染系统**: Canvas 2D渲染，支持多层背景
2. **物理系统**:
   - 碰撞检测系统（圆形和矩形碰撞盒）
   - 鱼线物理模拟
   - 移动约束和边界检测
   - 障碍物碰撞响应
3. **输入系统**: 触控虚拟摇杆和按钮
4. **AI系统**: 猎物行为逻辑和避障算法
5. **UI系统**: HUD界面、进度条、状态显示
6. **音效系统**: 环境音效和交互反馈

### 性能要求
- **帧率**: 60 FPS
- **响应时间**: 触控延迟 < 50ms
- **兼容性**: 支持主流移动浏览器

## 用户界面设计

### HUD布局
- **左下角**: 移动控制虚拟摇杆（移动端）
- **右下角**: 加速按钮 + 射击按钮（移动端）
- **右上角**: 体力条 + 氧气条
- **屏幕中央**: 鱼线耐久度进度条（连接时显示）
- **左上角**: 控制说明提示（PC端显示键盘操作，移动端显示触控说明）

### 控制方式

#### 移动端控制
- **虚拟摇杆**: 左下角触控摇杆控制移动方向
- **加速按钮**: 右下角按钮，按住加速游动
- **射击按钮**: 右下角圆形按钮，轮盘式瞄准射击
- **瞄准系统**: 在射击按钮区域滑动控制方向，显示虚线瞄准

#### PC端控制
- **移动控制**:
  - WASD键 控制移动方向
  - 支持八方向移动（斜向移动）
- **加速功能**:
  - Shift键（左Shift）按住加速游动
- **射击系统**:
  - 鼠标移动控制瞄准方向
  - 鼠标左键点击发射鱼枪
  - 实时显示鼠标指向的瞄准虚线
- **其他功能**:
  - 空格键作为备用射击键
  - ESC键暂停游戏（可选功能）

#### 自适应控制
- 系统自动检测设备类型（PC/移动端）
- PC端隐藏虚拟控制器，显示键盘操作提示
- 移动端隐藏鼠标相关提示，显示触控说明
- 支持PC端触屏设备的混合操作模式

### 视觉风格
- **色彩方案**: 深蓝海底主题，明亮UI元素
- **动画效果**: 流畅的水波纹理、生物游动动画
- **粒子效果**: 气泡、水流、射击特效

## 游戏流程

1. **游戏开始**: 主角出现在海面附近
2. **探索阶段**: 使用摇杆控制移动，寻找猎物
3. **狩猎阶段**: 瞄准并射击鱼枪
4. **捕获阶段**: 管理鱼线耐久，成功捕获猎物
5. **资源管理**: 监控体力和氧气，适时上浮补充

## 扩展功能（后续版本）

- 🏆 成就系统和排行榜
- 🎒 装备升级系统
- 🗺️ 多个海底区域
- 🐋 Boss级大型海洋生物
- 💰 经济系统和商店
- 🎵 动态背景音乐

## 开发里程碑

- [ ] 基础框架搭建
- [ ] 主角移动系统
- [ ] 鱼枪射击机制
- [ ] 鱼线物理系统
- [ ] 猎物AI实现
- [ ] UI界面完善
- [ ] 音效集成
- [ ] 性能优化
- [ ] 测试与调试

---

## 项目文件结构

```
autoGame_002_augment/
├── README.md           # 项目需求文档
├── index.html          # 完整版游戏主页面
├── game.js            # 完整版游戏逻辑代码
├── simple-game.html   # 简化演示版游戏
├── test.html          # 系统兼容性测试页面
├── pc-test.html       # PC端控制专项测试
├── keyboard-debug.html # 键盘输入调试工具
├── movement-test.html # 移动控制测试验证
└── demo.html          # 项目演示和导航页面
```

## 快速开始

1. **启动本地服务器**:
   ```bash
   python -m http.server 3000
   ```

2. **访问演示页面**:
   打开浏览器访问 `http://localhost:3000/demo.html`

3. **选择游戏版本**:
   - **完整版**: 包含所有功能的完整游戏体验
   - **演示版**: 简化版本，用于功能测试
   - **测试页**: 系统兼容性检查

## 开发状态

- [x] ✅ 基础框架搭建
- [x] ✅ 主角移动系统
- [x] ✅ 鱼枪射击机制
- [x] ✅ 鱼线物理系统
- [x] ✅ 猎物AI实现
- [x] ✅ UI界面完善
- [x] ✅ 触控操作支持
- [x] ✅ PC端键盘鼠标控制
- [x] ✅ 自适应设备检测
- [x] ✅ 性能优化
- [x] ✅ 测试与调试
- [x] ✅ Bug修复（D键移动问题）

## 技术实现亮点

- 🎮 **直观的触控界面**: 虚拟摇杆和轮盘式射击控制
- 🎯 **精确的瞄准系统**: 虚线显示射击方向，轮盘控制角度
- 🐟 **智能AI行为**: 不同类型猎物具有独特的逃脱模式
- ⚡ **流畅的物理系统**: 鱼线张力、碰撞检测、力学反馈
- 📱 **响应式设计**: 自适应不同屏幕尺寸和设备类型
- 🎨 **沉浸式视觉**: 海底渐变背景、动态UI元素


**开发团队**: Augment Agent
**项目类型**: 网页游戏
**目标平台**: 移动端浏览器
**开发语言**: HTML5 + JavaScript + CSS3
**开发时间**: 2025年9月
**版本**: v1.0.0
